---
  openapi: "3.0.3"
  info: 
    title: "Sugar Factory API"
    description: "Prompt over apis"
    version: "1.0.0"
  servers: 
    - 
      url: "http://localhost:3000/api"
  paths: 
    /packages: 
      get: 
        operationId: "prompt-getPackages"
        summary: "Read all packages"
        tags: 
          - "packages"
        parameters: 
          - 
            name: "userId"
            in: "query"
            required: false
            schema: 
              type: "string"
          - 
            name: "visibility"
            in: "query"
            required: false
            schema: 
              type: "string"
              enum: 
                - "PUBLIC"
                - "PRIVATE"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    anyOf: 
                      - 
                        type: "object"
                        properties: 
                          id: 
                            type: "string"
                          userId: 
                            type: "string"
                          name: 
                            type: "string"
                          visibility: 
                            type: "string"
                            enum: 
                              - "PUBLIC"
                              - "PRIVATE"
                          description: 
                            type: "string"
                          createdAt: 
                            type: "string"
                            format: "date-time"
                          updatedAt: 
                            type: "string"
                            format: "date-time"
                          templates: 
                            type: "array"
                            items: 
                              type: "object"
                              properties: 
                                id: 
                                  type: "string"
                                userId: 
                                  type: "string"
                                promptPackageId: 
                                  type: "string"
                                name: 
                                  type: "string"
                                description: 
                                  type: "string"
                                modelType: 
                                  type: "string"
                                  enum: 
                                    - "TEXT2TEXT"
                                    - "TEXT2IMAGE"
                                    - "TEXT2CODE"
                                    - "IMAGE2IMAGE"
                                runMode: 
                                  type: "string"
                                  enum: 
                                    - "AUTHORISED_ONLY"
                                    - "LOGGEDIN_ONLY"
                                    - "ALL"
                                releaseVersionId: 
                                  anyOf: 
                                    - 
                                      type: "string"
                                    - 
                                      enum: 
                                        - "null"
                                      nullable: true
                                previewVersionId: 
                                  anyOf: 
                                    - 
                                      type: "string"
                                    - 
                                      enum: 
                                        - "null"
                                      nullable: true
                                releaseVersion: 
                                  anyOf: 
                                    - 
                                      anyOf: 
                                        - 
                                          not: {}
                                        - 
                                          enum: 
                                            - "null"
                                          nullable: true
                                    - 
                                      type: "object"
                                      additionalProperties: {}
                                previewVersion: 
                                  anyOf: 
                                    - 
                                      anyOf: 
                                        - 
                                          not: {}
                                        - 
                                          enum: 
                                            - "null"
                                          nullable: true
                                    - 
                                      type: "object"
                                      additionalProperties: {}
                                createdAt: 
                                  type: "string"
                                  format: "date-time"
                                updatedAt: 
                                  type: "string"
                                  format: "date-time"
                              required: 
                                - "id"
                                - "userId"
                                - "promptPackageId"
                                - "name"
                                - "description"
                                - "modelType"
                                - "runMode"
                                - "releaseVersionId"
                                - "previewVersionId"
                                - "createdAt"
                                - "updatedAt"
                              additionalProperties: false
                        required: 
                          - "id"
                          - "userId"
                          - "name"
                          - "visibility"
                          - "description"
                          - "createdAt"
                          - "updatedAt"
                        additionalProperties: false
                      - 
                        enum: 
                          - "null"
                        nullable: true
          default: 
            $ref: "#/components/responses/error"
    /{username}/{packageName}/{template}/{versionOrEnvironment}/generate: 
      post: 
        operationId: "service-generate"
        summary: "Generate prompt completion"
        tags: 
          - "prompts"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  router: 
                    type: "object"
                    properties: 
                      mode: 
                        type: "string"
                        enum: 
                          - "auto"
                          - "manual"
                        default: "manual"
                      threshold: 
                        type: "number"
                        default: 0.5
                    additionalProperties: false
                  variables: 
                    type: "object"
                    additionalProperties: {}
                  messages: 
                    type: "array"
                    items: 
                      type: "object"
                      properties: 
                        role: 
                          type: "string"
                          enum: 
                            - "user"
                            - "assistant"
                            - "system"
                            - "tool"
                        content: 
                          type: "string"
                      required: 
                        - "role"
                        - "content"
                      additionalProperties: false
                    default: []
                  attachments: 
                    type: "object"
                    additionalProperties: {}
                  skills: 
                    type: "array"
                    items: 
                      type: "object"
                      properties: 
                        type: 
                          type: "string"
                          enum: 
                            - "function"
                        function: 
                          type: "object"
                          properties: 
                            name: 
                              type: "string"
                            description: 
                              type: "string"
                            parameters: 
                              type: "object"
                              properties: 
                                type: 
                                  type: "string"
                                properties: 
                                  type: "object"
                                  additionalProperties: 
                                    type: "object"
                                    properties: 
                                      type: 
                                        type: "string"
                                      description: 
                                        type: "string"
                                      enum: 
                                        type: "array"
                                        items: 
                                          type: "string"
                                    required: 
                                      - "type"
                                      - "description"
                                    additionalProperties: false
                                required: 
                                  type: "array"
                                  items: 
                                    type: "string"
                              required: 
                                - "type"
                                - "properties"
                                - "required"
                              additionalProperties: false
                          required: 
                            - "name"
                            - "description"
                            - "parameters"
                          additionalProperties: false
                      required: 
                        - "type"
                        - "function"
                      additionalProperties: false
                    default: []
                  skillChoice: 
                    type: "string"
                    enum: 
                      - "auto"
                      - "none"
                    default: "auto"
                  scope: 
                    type: "object"
                    properties: 
                      clientUserId: 
                        type: "string"
                      scope1: 
                        type: "string"
                        default: ""
                      scope2: 
                        type: "string"
                        default: ""
                      groupId: 
                        type: "string"
                        nullable: true
                    required: 
                      - "clientUserId"
                      - "groupId"
                    additionalProperties: false
                  isDevelopment: 
                    type: "boolean"
                    default: false
                  chat: 
                    type: "object"
                    properties: 
                      id: 
                        type: "string"
                        nullable: true
                      message: 
                        type: "object"
                        properties: 
                          role: 
                            type: "string"
                            enum: 
                              - "user"
                              - "assistant"
                              - "system"
                              - "tool"
                          content: 
                            type: "string"
                        required: 
                          - "role"
                          - "content"
                        additionalProperties: false
                        default: 
                          role: "user"
                          content: ""
                      historyChat: 
                        type: "number"
                        default: 6
                    required: 
                      - "id"
                    additionalProperties: false
                  copilotId: 
                    type: "string"
                  environment: 
                    type: "string"
                    enum: 
                      - "DEV"
                      - "PREVIEW"
                      - "RELEASE"
                  version: 
                    type: "string"
                  userId: 
                    type: "string"
                  promptPackageId: 
                    type: "string"
                  promptTemplateId: 
                    type: "string"
                  promptVersionId: 
                    type: "string"
                required: 
                  - "router"
                  - "variables"
                additionalProperties: false
        parameters: 
          - 
            name: "username"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "packageName"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "template"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "versionOrEnvironment"
            in: "path"
            required: true
            schema: 
              type: "string"
              default: "RELEASE"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  anyOf: 
                    - 
                      type: "object"
                      properties: 
                        id: 
                          type: "string"
                        environment: 
                          type: "string"
                          enum: 
                            - "DEV"
                            - "PREVIEW"
                            - "RELEASE"
                        version: 
                          type: "string"
                        prompt: 
                          type: "string"
                        completion: 
                          type: "string"
                          nullable: true
                        latency: 
                          type: "number"
                        prompt_tokens: 
                          type: "number"
                        completion_tokens: 
                          type: "number"
                        llmResponse: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                          nullable: true
                        promptVariables: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                          nullable: true
                        total_tokens: 
                          type: "number"
                        labelledState: 
                          type: "string"
                          enum: 
                            - "UNLABELLED"
                            - "SELECTED"
                            - "REJECTED"
                            - "NOTSURE"
                        llmProvider: 
                          type: "string"
                        llmModel: 
                          type: "string"
                        llmModelType: 
                          type: "string"
                          enum: 
                            - "TEXT2TEXT"
                            - "TEXT2IMAGE"
                            - "TEXT2CODE"
                            - "IMAGE2IMAGE"
                        chat: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                        createdAt: 
                          type: "string"
                          format: "date-time"
                        updatedAt: 
                          type: "string"
                          format: "date-time"
                        stats: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                          nullable: true
                      required: 
                        - "id"
                        - "environment"
                        - "version"
                        - "prompt"
                        - "completion"
                        - "latency"
                        - "prompt_tokens"
                        - "completion_tokens"
                        - "llmResponse"
                        - "promptVariables"
                        - "total_tokens"
                        - "labelledState"
                        - "llmProvider"
                        - "llmModel"
                        - "llmModelType"
                        - "createdAt"
                        - "updatedAt"
                      additionalProperties: false
                    - 
                      enum: 
                        - "null"
                      nullable: true
          default: 
            $ref: "#/components/responses/error"
    /{username}/{packageName}/{template}/{versionOrEnvironment}/generate/lite: 
      post: 
        operationId: "liteService-generate"
        summary: "Generate prompt completion"
        tags: 
          - "prompts"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  router: 
                    type: "object"
                    properties: 
                      mode: 
                        type: "string"
                        enum: 
                          - "auto"
                          - "manual"
                        default: "manual"
                      threshold: 
                        type: "number"
                        default: 0.5
                    additionalProperties: false
                  variables: 
                    type: "object"
                    additionalProperties: {}
                  messages: 
                    type: "array"
                    items: 
                      type: "object"
                      properties: 
                        role: 
                          type: "string"
                          enum: 
                            - "user"
                            - "assistant"
                            - "system"
                            - "tool"
                        content: 
                          type: "string"
                      required: 
                        - "role"
                        - "content"
                      additionalProperties: false
                    default: []
                  attachments: 
                    type: "object"
                    additionalProperties: {}
                  skills: 
                    type: "array"
                    items: 
                      type: "object"
                      properties: 
                        type: 
                          type: "string"
                          enum: 
                            - "function"
                        function: 
                          type: "object"
                          properties: 
                            name: 
                              type: "string"
                            description: 
                              type: "string"
                            parameters: 
                              type: "object"
                              properties: 
                                type: 
                                  type: "string"
                                properties: 
                                  type: "object"
                                  additionalProperties: 
                                    type: "object"
                                    properties: 
                                      type: 
                                        type: "string"
                                      description: 
                                        type: "string"
                                      enum: 
                                        type: "array"
                                        items: 
                                          type: "string"
                                    required: 
                                      - "type"
                                      - "description"
                                    additionalProperties: false
                                required: 
                                  type: "array"
                                  items: 
                                    type: "string"
                              required: 
                                - "type"
                                - "properties"
                                - "required"
                              additionalProperties: false
                          required: 
                            - "name"
                            - "description"
                            - "parameters"
                          additionalProperties: false
                      required: 
                        - "type"
                        - "function"
                      additionalProperties: false
                    default: []
                  skillChoice: 
                    type: "string"
                    enum: 
                      - "auto"
                      - "none"
                    default: "auto"
                  scope: 
                    type: "object"
                    properties: 
                      clientUserId: 
                        type: "string"
                      scope1: 
                        type: "string"
                        default: ""
                      scope2: 
                        type: "string"
                        default: ""
                      groupId: 
                        type: "string"
                        nullable: true
                    required: 
                      - "clientUserId"
                      - "groupId"
                    additionalProperties: false
                  isDevelopment: 
                    type: "boolean"
                    default: false
                  chat: 
                    type: "object"
                    properties: 
                      id: 
                        type: "string"
                        nullable: true
                      message: 
                        type: "object"
                        properties: 
                          role: 
                            type: "string"
                            enum: 
                              - "user"
                              - "assistant"
                              - "system"
                              - "tool"
                          content: 
                            type: "string"
                        required: 
                          - "role"
                          - "content"
                        additionalProperties: false
                        default: 
                          role: "user"
                          content: ""
                      historyChat: 
                        type: "number"
                        default: 6
                    required: 
                      - "id"
                    additionalProperties: false
                  copilotId: 
                    type: "string"
                  environment: 
                    type: "string"
                    enum: 
                      - "DEV"
                      - "PREVIEW"
                      - "RELEASE"
                  version: 
                    type: "string"
                  userId: 
                    type: "string"
                  promptPackageId: 
                    type: "string"
                  promptTemplateId: 
                    type: "string"
                  promptVersionId: 
                    type: "string"
                required: 
                  - "router"
                  - "variables"
                additionalProperties: false
        parameters: 
          - 
            name: "username"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "packageName"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "template"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "versionOrEnvironment"
            in: "path"
            required: true
            schema: 
              type: "string"
              default: "RELEASE"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  anyOf: 
                    - 
                      type: "object"
                      properties: 
                        llmResponse: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                          nullable: true
                        chat: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                        stats: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                          nullable: true
                        router: 
                          type: "object"
                          properties: 
                            mode: 
                              type: "string"
                              enum: 
                                - "auto"
                                - "manual"
                            match: 
                              type: "string"
                            prompt: 
                              type: "string"
                            score: 
                              type: "number"
                            threshold: 
                              type: "number"
                            text: 
                              type: "string"
                          required: 
                            - "mode"
                            - "match"
                            - "prompt"
                            - "score"
                            - "threshold"
                            - "text"
                          additionalProperties: false
                      additionalProperties: false
                    - 
                      enum: 
                        - "null"
                      nullable: true
          default: 
            $ref: "#/components/responses/error"
    /{username}/{packageName}/{template}/{versionOrEnvironment}: 
      get: 
        operationId: "cube-getPrompt"
        summary: "Get Prompt Template"
        tags: 
          - "prompts"
        parameters: 
          - 
            name: "environment"
            in: "query"
            required: false
            schema: 
              type: "string"
              enum: 
                - "DEV"
                - "PREVIEW"
                - "RELEASE"
          - 
            name: "username"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "packageName"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "template"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "version"
            in: "query"
            required: false
            schema: 
              type: "string"
          - 
            name: "versionOrEnvironment"
            in: "path"
            required: true
            schema: 
              type: "string"
              default: "RELEASE"
          - 
            name: "userId"
            in: "query"
            required: false
            schema: 
              type: "string"
          - 
            name: "promptPackageId"
            in: "query"
            required: false
            schema: 
              type: "string"
          - 
            name: "promptTemplateId"
            in: "query"
            required: false
            schema: 
              type: "string"
          - 
            name: "promptVersionId"
            in: "query"
            required: false
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  anyOf: 
                    - 
                      type: "object"
                      properties: 
                        version: 
                          type: "string"
                        template: 
                          type: "string"
                        promptData: {}
                        llmProvider: 
                          type: "string"
                        model: 
                          type: "string"
                        description: 
                          type: "string"
                        modelType: 
                          type: "string"
                          enum: 
                            - "TEXT2TEXT"
                            - "TEXT2IMAGE"
                            - "TEXT2CODE"
                            - "IMAGE2IMAGE"
                        versionOrEnvironment: 
                          type: "string"
                          default: "RELEASE"
                        createdAt: 
                          type: "string"
                          format: "date-time"
                        updatedAt: 
                          type: "string"
                          format: "date-time"
                        promptPackageId: 
                          type: "string"
                        templateId: 
                          type: "string"
                        runMode: 
                          type: "string"
                          enum: 
                            - "AUTHORISED_ONLY"
                            - "LOGGEDIN_ONLY"
                            - "ALL"
                      required: 
                        - "template"
                        - "llmProvider"
                        - "model"
                        - "modelType"
                        - "createdAt"
                        - "updatedAt"
                        - "promptPackageId"
                        - "templateId"
                        - "runMode"
                      additionalProperties: false
                    - 
                      enum: 
                        - "null"
                      nullable: true
          default: 
            $ref: "#/components/responses/error"
    /copilots/{copilotId}/embeddings: 
      post: 
        operationId: "embedding-createOrUpdate"
        summary: "Generate data embeddings"
        tags: 
          - "embedding"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  scope: 
                    type: "object"
                    properties: 
                      clientUserId: 
                        type: "string"
                      scope1: 
                        type: "string"
                        default: ""
                      scope2: 
                        type: "string"
                        default: ""
                      groupId: 
                        type: "string"
                        nullable: true
                    required: 
                      - "clientUserId"
                      - "groupId"
                    additionalProperties: false
                  payload: {}
                  strategy: 
                    type: "string"
                required: 
                  - "scope"
                additionalProperties: false
        parameters: 
          - 
            name: "copilotId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    count: 
                      type: "number"
                    strategy: 
                      type: "string"
                  required: 
                    - "count"
                  additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
    /copilots/{copilotId}/embeddings/lookup: 
      post: 
        operationId: "embedding-lookup"
        summary: "Get data embeddings"
        tags: 
          - "embedding"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  userId: 
                    type: "string"
                  scope: 
                    type: "object"
                    properties: 
                      clientUserId: 
                        type: "string"
                      scope1: 
                        type: "string"
                        default: ""
                      scope2: 
                        type: "string"
                        default: ""
                      groupId: 
                        type: "string"
                        nullable: true
                    required: 
                      - "clientUserId"
                      - "groupId"
                    additionalProperties: false
                  userQuery: 
                    type: "string"
                required: 
                  - "scope"
                  - "userQuery"
                additionalProperties: false
        parameters: 
          - 
            name: "copilotId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    type: "object"
                    properties: 
                      id: 
                        type: "string"
                      copilotId: 
                        type: "string"
                      identifier: 
                        type: "string"
                      chunk: 
                        type: "string"
                      doc: 
                        type: "string"
                      similarity: 
                        type: "number"
                    required: 
                      - "id"
                      - "copilotId"
                      - "identifier"
                      - "chunk"
                      - "doc"
                      - "similarity"
                    additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
    /copilot/{copilotId}/chats: 
      post: 
        operationId: "chat-generateChat"
        summary: "Generate chat"
        tags: 
          - "chat"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  messageCount: 
                    type: "number"
                    default: 0
                additionalProperties: false
        parameters: 
          - 
            name: "copilotId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  anyOf: 
                    - 
                      type: "object"
                      properties: 
                        copilotId: 
                          type: "string"
                        messageCount: 
                          type: "number"
                          default: 0
                        id: 
                          type: "string"
                        userId: 
                          type: "string"
                        createdAt: 
                          type: "string"
                          format: "date-time"
                        updatedAt: 
                          type: "string"
                          format: "date-time"
                      required: 
                        - "copilotId"
                        - "id"
                        - "userId"
                        - "createdAt"
                        - "updatedAt"
                      additionalProperties: false
                    - 
                      enum: 
                        - "null"
                      nullable: true
          default: 
            $ref: "#/components/responses/error"
    /copilot/{copilotId}/chats/{chatId}/messages: 
      post: 
        operationId: "message-generateMessage"
        summary: "Generate chat message"
        tags: 
          - "message"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  logId: 
                    type: "string"
                  content: 
                    type: "string"
                  role: 
                    type: "string"
                    enum: 
                      - "user"
                      - "assistant"
                      - "system"
                  metadata: 
                    anyOf: 
                      - 
                        type: "string"
                      - 
                        type: "number"
                      - 
                        type: "boolean"
                      - 
                        type: "array"
                        items: 
                          nullable: true
                      - 
                        type: "object"
                        additionalProperties: 
                          nullable: true
                    nullable: true
                required: 
                  - "content"
                  - "role"
                  - "metadata"
                additionalProperties: false
        parameters: 
          - 
            name: "copilotId"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "chatId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  anyOf: 
                    - 
                      type: "object"
                      properties: 
                        copilotId: 
                          type: "string"
                        logId: 
                          type: "string"
                        content: 
                          type: "string"
                        role: 
                          type: "string"
                          enum: 
                            - "user"
                            - "assistant"
                            - "system"
                        chatId: 
                          type: "string"
                        metadata: 
                          anyOf: 
                            - 
                              type: "string"
                            - 
                              type: "number"
                            - 
                              type: "boolean"
                            - 
                              type: "array"
                              items: 
                                nullable: true
                            - 
                              type: "object"
                              additionalProperties: 
                                nullable: true
                          nullable: true
                        id: 
                          type: "string"
                        userId: 
                          type: "string"
                        createdAt: 
                          type: "string"
                          format: "date-time"
                        updatedAt: 
                          type: "string"
                          format: "date-time"
                      required: 
                        - "copilotId"
                        - "content"
                        - "role"
                        - "chatId"
                        - "metadata"
                        - "id"
                        - "userId"
                        - "createdAt"
                        - "updatedAt"
                      additionalProperties: false
                    - 
                      enum: 
                        - "null"
                      nullable: true
          default: 
            $ref: "#/components/responses/error"
      get: 
        operationId: "message-getChatHistory"
        summary: "Get chat messages"
        tags: 
          - "chat_history"
        parameters: 
          - 
            name: "chatId"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "copilotId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "array"
                  items: 
                    type: "object"
                    properties: 
                      copilotId: 
                        type: "string"
                      logId: 
                        type: "string"
                      content: 
                        type: "string"
                      role: 
                        type: "string"
                        enum: 
                          - "user"
                          - "assistant"
                          - "system"
                      chatId: 
                        type: "string"
                      metadata: 
                        anyOf: 
                          - 
                            type: "string"
                          - 
                            type: "number"
                          - 
                            type: "boolean"
                          - 
                            type: "array"
                            items: 
                              nullable: true
                          - 
                            type: "object"
                            additionalProperties: 
                              nullable: true
                        nullable: true
                      id: 
                        type: "string"
                      userId: 
                        type: "string"
                      createdAt: 
                        type: "string"
                        format: "date-time"
                      updatedAt: 
                        type: "string"
                        format: "date-time"
                    required: 
                      - "copilotId"
                      - "content"
                      - "role"
                      - "chatId"
                      - "metadata"
                      - "id"
                      - "userId"
                      - "createdAt"
                      - "updatedAt"
                    additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
    /voice-forms/{formId}/submissions: 
      get: 
        operationId: "form-getSubmissions"
        summary: "Get a summary of submissions for a voice form"
        tags: 
          - "VoiceForm"
        parameters: 
          - 
            name: "formId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: {}
          default: 
            $ref: "#/components/responses/error"
    /voice-forms/{formId}/submission/{submissionId}: 
      get: 
        operationId: "form-getSubmission"
        summary: "Get details of a single submission"
        tags: 
          - "VoiceForm"
        parameters: 
          - 
            name: "formId"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "submissionId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    id: 
                      type: "string"
                    formId: 
                      type: "string"
                    userId: 
                      type: "string"
                    clientUserId: 
                      type: "string"
                    metadata: 
                      anyOf: 
                        - 
                          type: "string"
                        - 
                          type: "number"
                        - 
                          type: "boolean"
                        - 
                          type: "array"
                          items: {}
                        - 
                          type: "object"
                          additionalProperties: {}
                    submittedAt: 
                      type: "string"
                      format: "date-time"
                      nullable: true
                    createdAt: 
                      type: "string"
                      format: "date-time"
                    updatedAt: 
                      type: "string"
                      format: "date-time"
                    answers: 
                      type: "array"
                      items: 
                        type: "object"
                        properties: 
                          questionId: 
                            type: "string"
                          answer: {}
                          metadata: 
                            anyOf: 
                              - 
                                type: "string"
                              - 
                                type: "number"
                              - 
                                type: "boolean"
                              - 
                                type: "array"
                                items: {}
                              - 
                                type: "object"
                                additionalProperties: {}
                          updatedAt: 
                            type: "string"
                            format: "date-time"
                          createdAt: 
                            type: "string"
                            format: "date-time"
                        required: 
                          - "questionId"
                          - "metadata"
                          - "updatedAt"
                          - "createdAt"
                        additionalProperties: false
                  required: 
                    - "id"
                    - "formId"
                    - "userId"
                    - "clientUserId"
                    - "metadata"
                    - "submittedAt"
                    - "createdAt"
                    - "updatedAt"
                    - "answers"
                  additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
    /voice-forms/{formId}/submission: 
      post: 
        operationId: "formSubmission-createSubmission"
        summary: "Create a new submission for voice form for user with clientUserId "
        tags: 
          - "VoiceForm"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  clientUserId: 
                    type: "string"
                  metadata: 
                    anyOf: 
                      - 
                        type: "string"
                      - 
                        type: "number"
                      - 
                        type: "boolean"
                      - 
                        type: "array"
                        items: {}
                      - 
                        type: "object"
                        additionalProperties: {}
                required: 
                  - "clientUserId"
                  - "metadata"
                additionalProperties: false
        parameters: 
          - 
            name: "formId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    submissionId: 
                      type: "string"
                  required: 
                    - "submissionId"
                  additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
    /voice-forms/{formId}/submission/{submissionId}/questions/{questionId}/answer: 
      post: 
        operationId: "formSubmission-submitAnswer"
        summary: "Submit voice form with answers"
        tags: 
          - "VoiceForm"
        requestBody: 
          required: true
          content: 
            application/json: 
              schema: 
                type: "object"
                properties: 
                  clientUserId: 
                    type: "string"
                  answer: 
                    type: "object"
                    properties: 
                      recording: 
                        type: "object"
                        properties: 
                          audioUrl: 
                            type: "string"
                          audioFile: {}
                        required: 
                          - "audioUrl"
                          - "audioFile"
                        additionalProperties: false
                        nullable: true
                      rawAnswer: 
                        type: "string"
                        nullable: true
                      evaluatedAnswer: 
                        type: "string"
                        nullable: true
                      by: 
                        type: "string"
                        enum: 
                          - "voice"
                          - "keyboard"
                      qualificationScore: 
                        type: "number"
                        nullable: true
                      qualificationSummary: 
                        type: "string"
                        nullable: true
                    required: 
                      - "recording"
                      - "rawAnswer"
                      - "evaluatedAnswer"
                      - "by"
                      - "qualificationScore"
                      - "qualificationSummary"
                    additionalProperties: false
                  metadata: 
                    anyOf: 
                      - 
                        type: "string"
                      - 
                        type: "number"
                      - 
                        type: "boolean"
                      - 
                        type: "array"
                        items: {}
                      - 
                        type: "object"
                        additionalProperties: {}
                required: 
                  - "clientUserId"
                  - "answer"
                  - "metadata"
                additionalProperties: false
        parameters: 
          - 
            name: "formId"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "submissionId"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "questionId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    id: 
                      type: "string"
                  required: 
                    - "id"
                  additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
    /voice-forms/{formId}/submission/{submissionId}/complete: 
      post: 
        operationId: "formSubmission-completeSubmission"
        summary: "Finalize a submission after all answers are submitted"
        tags: 
          - "VoiceForm"
        parameters: 
          - 
            name: "formId"
            in: "path"
            required: true
            schema: 
              type: "string"
          - 
            name: "submissionId"
            in: "path"
            required: true
            schema: 
              type: "string"
        responses: 
          200: 
            description: "Successful response"
            content: 
              application/json: 
                schema: 
                  type: "object"
                  properties: 
                    submissionId: 
                      type: "string"
                    message: 
                      type: "string"
                  required: 
                    - "submissionId"
                    - "message"
                  additionalProperties: false
          default: 
            $ref: "#/components/responses/error"
  components: 
    securitySchemes: 
      Authorization: 
        type: "http"
        scheme: "bearer"
    responses: 
      error: 
        description: "Error response"
        content: 
          application/json: 
            schema: 
              type: "object"
              properties: 
                message: 
                  type: "string"
                code: 
                  type: "string"
                issues: 
                  type: "array"
                  items: 
                    type: "object"
                    properties: 
                      message: 
                        type: "string"
                    required: 
                      - "message"
                    additionalProperties: false
              required: 
                - "message"
                - "code"
              additionalProperties: false
  tags: 
    - 
      name: "prompts"
  externalDocs: 
    url: "https://github.com/sugarcane-ai/factory"

